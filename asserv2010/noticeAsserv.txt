Protocole de communication pic asservissement slave i2c <-> master i2c STR912 :

TRAME ECRITURE standard
start, adresse + write, 10 , MSB X1, LSB X1, MSB Y1, LSB Y1, MSB X2, LSB X2, MSB Y2, LSB Y2, SPEED, CRC, stop 
TRAME ECRITURE configuration
start, adresse + write, 7 , MSB X, LSB X, MSB Y, LSB Y, ORIENTATION MSB,ORIENTATION LSB, CRC, stop 


TRAME LECTURE standard
start, adresse + read, MSB X, LSB X, MSB Y, LSB Y, ORIENTATION MSB,ORIENTATION LSB, STATUS, CRC, stop 

CRC = xor de tout les octets(taille ou commande comprise)sur 8 bits

un point dans le terrain est définis par une position en x comprise entre 0 compris et 3000 et une position
en y entre 0 compris et 2150


OPERATION REALISABLE PAR ECRITURE

-Donner 2 points en dehors du terrain, identique ou non, desactive l'asservissement en orientation.
On l'utilise pour se recaler.
Mettre 2 points identiques prochent de la bordure permet de ralentir avant de toucher la bordure
Si les 2 points sont différents le robot ne ralenti pas.

-Donner 1 points sur le terrain et un point en dehors :
Le robot va d'abord s'asservir sur la position du 1er point puis s'orienter vers le 2ème
Cela permet de s'orienter vers un point precis

-Donner 2 points identiques dans le terrain :
signifie au robot qu'il doit s'arreter sur la position donnée

si le robot est en mouvement il deccelerera en arrivant a ce point
si le robot est a l'arret il accelerera et ralentira en arrivant

-Donner 2 points differents sur le terrain :
si le robot est en mouvement il s'asservit sur le premier point et passe automatiquement au 2eme s'il l'atteint 
si le robot est a l'arret il commence par accelerer
Le robot ralentit quand l'ecart entre son orientation et sa cible et supérieur a 90° en absolu

-Donner les meme types de couple de points avec une vitesse negative
conduit a faire rouler le robot en marche arriere sauf bien sur durant une orientation

- une vitesse égale a 0 et 2 points égaux asservis le robot sur place de facon brutale
- une absence de nouvelles consignes durant 100 ms desactive l'asservissement (PWM = 0)
